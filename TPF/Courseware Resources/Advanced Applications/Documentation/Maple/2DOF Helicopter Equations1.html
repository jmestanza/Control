<head>
<title>2DOF Helicopter Equations.html</title>
<!-- Created by Maple 9.03, IBM INTEL NT -->
</head>
<body bgcolor="FFFFFF">
<basefont size="3">
<a name="MapleAutoBookmark1" />
<p align="center">
<b><u><font color="#000000" size="6">Dynamic Equations for the 2 DOF Helicopter </font></u></b>
</p>
<p align="center">
<i><font color="#000000">©</font></i>
<i><font color="#000000">&nbsp;2006 Quanser Consulting Inc.</font></i>
</p>
<p align="center">
<font color="#000000">URL: </font>
<a href="http://www.quanser.com" target="_top">http://www.quanser.com</a></p>
<p align="center">
<font color="#000000" size="2">NOTE: This worksheet presents the general dynamic equations modelling a 2 DOF Helicopter.</font>
</p>
<p align="center"><a name="Description" />
</p>
<dl><a name="MapleAutoBookmark2" />
<p align="left">
<b><font color="#000000" size="5">Description</font></b>
</p>
<ul><li>
<font color="#000000">This worksheet presents the general dynamic equations modelling a two-degree of freedom helicopter.</font>
</li>
<li>
<font color="#000000">Specifically, this worksheet is used to derive the state-space matrices for the Quanser's </font>
<b><font color="#000000">2 DOF Helicopter </font></b>
<font color="#000000">experiment.</font>
</li>
<li>
<font color="#000000">The Lagrange's method is used to obtain the dynamic model of the system.</font>
</li>
<dl><a name="MapleAutoBookmark3" />
</ul>
<p align="left">
<b><font color="#000000" size="4">The </font></b>
<i><b><font color="#000000" size="4">Quanser_Tools</font></b></i>
<b><font color="#000000" size="4">&nbsp;Package</font></b>
</p>
<ul><li>
<font color="#000000">The </font>
<i><font color="#000000">Quanser_Tools</font></i>
<font color="#000000">&nbsp;module defines generic procedures and data in relation to determining the state-space representation of all the Quanser experiments. Specifically, this means deriving and solving the Lagrange's equations of the Quanser systems.</font>
</li>
<li>
<font color="#000000">The </font>
<i><font color="#000000">quanser</font></i>
<font color="#000000">&nbsp;repository containing the </font>
<i><font color="#000000">Quanser_Tools</font></i>
<font color="#000000">&nbsp;package is implemented in the 2 following files: </font>
<i><font color="#000000">quanser.ind</font></i>
<font color="#000000">&nbsp;and </font>
<i><font color="#000000">quanser.lib.</font></i>
<font color="#000000">&nbsp;If these two files are not readily available, they can be generated by executing the Maple worksheet titled: </font>
<i><font color="#000000">quanser_tools.mws</font></i>
<font color="#000000">.</font>
</li>
<li>
<b><font color="#000000">To install</font></b>
<font color="#000000">&nbsp;the </font>
<i><font color="#000000">Quanser_Tools</font></i>
<font color="#000000">&nbsp;package, copy the two files </font>
<i><font color="#000000">quanser.ind</font></i>
<font color="#000000">&nbsp;and </font>
<i><font color="#000000">quanser.lib</font></i>
<font color="#000000">&nbsp;&nbsp;into a directory of your choice, like for example: "C:\Program Files\Quanser\Maple Repository". </font>
</li>
<li>
<b><font color="#000000">To use</font></b>
<font color="#000000">&nbsp;the </font>
<i><font color="#000000">Quanser_Tools</font></i>
<font color="#000000">&nbsp;package in a Maple worksheet, add the path to its disk location to the Maple global variable </font>
<i><font color="#000000">libname</font></i>
<font color="#000000">. For example, this can be achieved by the following Maple command: <br />
libname := </font>
<i><font color="#000000">&nbsp;"C:/Program Files/Quanser/Maple Repository", libname:</font></i>
</li>
</dl><dl><a name="MapleAutoBookmark4" />
</ul>
<p align="left">
<b><font color="#000000" size="4">References</font></b>
</p>
<ul><li>
<font color="#000000">For an overview of some of the possible control challenges offered by the Quanser Speciatly experiments please visit the following link on the Quanser's website: </font>
<a href="http://www.quanser.com/english/html/challenges/fs_chall_specialty_flash.htm" target="_top">Specialty Control Challenges</a></li>
</dl></ul>
<p align="left">
</p>
</dl><dl><a name="MapleAutoBookmark5" />
<p align="left">
<b><font color="#000000" size="5">Worksheet Initialization</font></b>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">restart: interface( imaginaryunit = j ): </font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">with( LinearAlgebra ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">libname := "C:/Program Files/Quanser/Maple Repository", ".", libname:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">with( Quanser_Tools );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations1.gif" width="889" height="20" alt="[deriveA, deriveB, deriveF, kinetic_energy, lagrange_equations, moment_of_inertia, n_norm, potential_energy, write_ABCD_to_Mfile]" />
</p>
<p align="left">
<font color="#000000">environment variable representing the order of series calculations</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Order := 2:</font></b>
</td></tr>
</table>
</p>
</dl><dl><a name="MapleAutoBookmark6" />
<p align="left"><a name="Notations" />
<b><font color="#000000" size="5">Notations</font></b>
</p>
<dl><a name="MapleAutoBookmark7" />
<p align="left">
<b><font color="#000000" size="4">Generalized Coordinates: </font></b>
<img src="images/2DOF Helicopter Equations2.gif" width="29" height="36" alt="q[i]" align="middle" />
<b><font color="#000000" size="4">'s</font></b>
</p>
<p align="left">
<font color="#000000">The generalized coordinates are also called Lagrangian coordinates.</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations3.gif" width="43" height="32" alt="theta(t)" align="middle" />
<font color="#000000">&nbsp;= &nbsp;pitch angle</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations4.gif" width="47" height="32" alt="psi(t)" align="middle" />
<font color="#000000">&nbsp;= yaw angle</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">q := [ theta(t), psi(t)];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations5.gif" width="124" height="20" alt="q := [theta(t), psi(t)]" />
</p>
<p align="left">
<font color="#000000">Nq = number of Lagrangian coordinates (e.g. here, it is Nq = 2)</font>
</p>
<p align="left">
<font color="#000000">Nq is also the number of position states.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Nq := nops( q ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">qd = first-order time derivative of the generalized coordinates, e.g. position and angular velocities</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">qd := map( diff, q, t );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations6.gif" width="168" height="45" alt="qd := [diff(theta(t),t), diff(psi(t),t)]" />
</p>
</dl><dl><a name="MapleAutoBookmark8" />
<p align="left">
<b><font color="#000000" size="4">Transformation Matrices</font></b>
</p>
<p align="left">
<font color="#000000">Rotate base coordinate about yaw: T_0_1 = Rot(Z0, psi)</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T_0_1 := matrix(4,4,[<br />
cos(-q[2]),-sin(-q[2]),0,0,<br />
sin(-q[2]),cos(-q[2]),0,0,<br />
0,0,1,0,<br />
0,0,0,1]);</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations7.gif" width="289" height="110" alt="T_0_1 := matrix([[cos(psi(t)), sin(psi(t)), 0, 0], [-sin(psi(t)), cos(psi(t)), 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]])" />
</p>
<p align="left">
<font color="#000000">Rotate about pitch: T_1_2 = &nbsp;Rot(Y1, theta)</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T_1_2 := matrix(4,4,[<br />
cos(-q[1]),0,sin(-q[1]),0,<br />
0,1,0,0,<br />
-sin(-q[1]),0,cos(-q[1]),0,<br />
0,0,0,1]);</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations8.gif" width="281" height="110" alt="T_1_2 := matrix([[cos(theta(t)), 0, -sin(theta(t)), 0], [0, 1, 0, 0], [sin(theta(t)), 0, cos(theta(t)), 0], [0, 0, 0, 1]])" />
</p>
<p align="left">
<font color="#000000">Translate about O2 to center of mass of helicopter: T_2_3 = Trans(X2, lcm)</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T_2_3 := matrix(4,4,[<br />
1,0,0,l[cm],<br />
0,1,0,0,<br />
0,0,1,0,<br />
0,0,0,1]);</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations9.gif" width="204" height="117" alt="T_2_3 := matrix([[1, 0, 0, l[cm]], [0, 1, 0, 0], [0, 0, 1, 0], [0, 0, 0, 1]])" />
</p>
<p align="left">
<font color="#000000">Base coordinate system, O0, to center of mass , O3: T_0_3 = T_0_1 * T_1_2 * T_2_3</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T_0_3 := evalm( T_0_1 &amp;* T_1_2 &amp;* T_2_3);</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations10.gif" width="638" height="131" alt="T_0_3 := matrix([[cos(psi(t))*cos(theta(t)), sin(psi(t)), -cos(psi(t))*sin(theta(t)), cos(psi(t))*cos(theta(t))*l[cm]], [-sin(psi(t))*cos(theta(t)), cos(psi(t)), sin(psi(t))*sin(theta(t)), -sin(psi(t))..." />
</p>
</dl><p align="left">
</p>
<dl><a name="MapleAutoBookmark9" />
<p align="left">
<b><font color="#000000" size="4">Cartesian Coordinates of the Helicopter's Centre Of Gravity </font></b>
</p>
<p align="left">
<font color="#000000">conventions:</font>
</p>
<p align="left">
<font color="#000000">1) </font>
<img src="images/2DOF Helicopter Equations11.gif" width="49" height="32" alt="theta = 0" align="middle" />
<font color="#000000">&nbsp;corresponds to the helicopter being horizontal</font>
</p>
<p align="left">
<font color="#000000">2) positive rotation about pitch axis, &nbsp;</font>
<img src="images/2DOF Helicopter Equations12.gif" width="85" height="58" alt="0 &lt; diff(theta(t),t)" align="middle" />
<font color="#000000">, is CCW</font>
</p>
<p align="left">
<font color="#000000">3) positive rotation of about yaw axis, </font>
<img src="images/2DOF Helicopter Equations13.gif" width="89" height="58" alt="0 &lt; diff(psi(t),t)" align="middle" />
<font color="#000000">&nbsp;, is CW.</font>
</p>
<p align="left">
<font color="#000000">Absolute 3-dimensional Cartesian position: CM of 2 DOF Helicopter.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">x[cm] := T_0_3[1,4];<br />
y[cm] := T_0_3[2,4];<br />
z[cm] := T_0_3[3,4];</font></b>
</td></tr>
</table>
</p>
<p align="left">
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations14.gif" width="222" height="27" alt="x[cm] := cos(psi(t))*cos(theta(t))*l[cm]" />
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations15.gif" width="225" height="27" alt="y[cm] := -sin(psi(t))*cos(theta(t))*l[cm]" />
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations16.gif" width="145" height="27" alt="z[cm] := sin(theta(t))*l[cm]" />
</p>
<p align="left">
<font color="#000000">Absolute 3-dimensional Cartesian velocities.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">xd[cm] := diff( x[cm], t );<br />
yd[cm] := diff( y[cm], t );<br />
zd[cm] := diff( z[cm], t );<br />
</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations17.gif" width="537" height="45" alt="xd[cm] := -sin(psi(t))*diff(psi(t),t)*cos(theta(t))*l[cm]-cos(psi(t))*sin(theta(t))*diff(theta(t),t)*l[cm]" />
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations18.gif" width="536" height="45" alt="yd[cm] := -cos(psi(t))*diff(psi(t),t)*cos(theta(t))*l[cm]+sin(psi(t))*sin(theta(t))*diff(theta(t),t)*l[cm]" />
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations19.gif" width="222" height="45" alt="zd[cm] := cos(theta(t))*diff(theta(t),t)*l[cm]" />
</p>
<p align="left">
</p>
</dl><dl><a name="MapleAutoBookmark10" />
<p align="left">
<b><font color="#000000" size="4">State-Space Variables</font></b>
</p>
<ul><li>
<font color="#000000">The chosen states should at least include the generalized coordinates and their first-time derivatives.</font>
</li>
<li>
<font color="#000000">X is the state vector.</font>
</li>
<li>
<font color="#000000">In the state vector X: Lagrangian coordinates are first, followed by their first-time derivatives, and finally any other states, as required.</font>
</li>
</ul>
<p align="left">
<font color="#000000">Substitution sets for the states (to obtain time-independent state equations).</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_Xq := { seq( q[i] = X[i], i=1..Nq ) };<br />
subs_Xqd := { seq( qd[i] = X[i+Nq], i=1..Nq ) };</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations20.gif" width="245" height="27" alt="subs_Xq := {theta(t) = X[1], psi(t) = X[2]}" />
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations21.gif" width="287" height="45" alt="subs_Xqd := {diff(theta(t),t) = X[3], diff(psi(t),t) = X[4]}" />
</p>
<p align="left">
<font color="#000000">Substitution set for the input(s). set the input to be the motor voltage:</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_U := { V[m_p] = U[1], V[m_y] = U[2] }:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">set the input to be the torque applied by the motor shaft, </font>
<img src="images/2DOF Helicopter Equations22.gif" width="65" height="32" alt="tau[output]" align="middle" />
<font color="#000000">&nbsp;(if not expressed as a function of the motor voltage): </font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">#subs_U := { tau[p] = U[1], tau[y] = U[2] }:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Nu = number of inputs; U = input (row) vector (e.g. U = [ V[m] ] )</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Nu := nops( subs_U ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">substitution set for the position states' second time derivatives</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_Xqdd := { seq( diff( q[i], t$2 ) = &nbsp;Xd[i+Nq], i=1..Nq ) };</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations23.gif" width="330" height="63" alt="subs_Xqdd := {diff(theta(t),`$`(t,2)) = Xd[3], diff(psi(t),`$`(t,2)) = Xd[4]}" />
</p>
<p align="left">
<font color="#000000">second time derivatives of the position states (written as time-independent variables).</font>
</p>
<p align="left">
<font color="#000000">The set of unknowns is obtained from this list to solve the Lagrange's equations of motion.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Xqdd := [ seq( Xd[i+Nq], i=1..Nq ) ];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations24.gif" width="144" height="27" alt="Xqdd := [Xd[3], Xd[4]]" />
</p>
<p align="left">
<font color="#000000">substitution set to linearize the state-space matrices (i.e. A and B) </font>
</p>
<p align="left">
<font color="#000000">about the quiescent null state vector (small-displacement theory)</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_XUzero := { seq( X[i] = 0, i=1..2*Nq ), seq( U[i] = 0, i=1..Nu ) }:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Nx = dim( X ) = total number of states (should be greater than or equal to: 2 * Nq)</font>
</p>
<p align="left">
<font color="#000000">Ny = chosen number of outputs</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Nx := 2 * Nq + 0:<br />
Ny := Nq:</font></b>
</td></tr>
</table>
</p>
</dl></dl><dl><a name="MapleAutoBookmark11" />
<p align="left">
<b><font color="#000000" size="5">Total Potential and Kinetic Energies of the System</font></b>
</p>
<p align="left">
<font color="#000000">The total potential and kinetic energies are needed to calculate the Lagrangian of the system.</font>
</p>
<dl><a name="MapleAutoBookmark12" />
<p align="left">
<b><font color="#000000" size="4">Total Potential Energy: </font></b>
<img src="images/2DOF Helicopter Equations25.gif" width="39" height="36" alt="V[T]" align="middle" />
<b><font color="#000000" size="4">&nbsp;</font></b>
</p>
<p align="left">
<font color="#000000">The total potential energy can be expressed in terms of the generalized coordinates alone.</font>
</p>
<p align="left">
<font color="#000000">V[e] = Total Elastic Potential Energy of the system</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">V[e] := 0: </font></b>
</td></tr>
</table>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations26.gif" width="34" height="32" alt="V[g]" align="middle" />
<font color="#000000">&nbsp;= potential energy of helicopter.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">V[g] := potential_energy( 'gravity', m[heli], g, z[cm] ); </font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations27.gif" width="189" height="27" alt="V[g] := m[heli]*g*sin(theta(t))*l[cm]" />
</p>
<p align="left">
<font color="#000000">V[T] = Total Potential Energy of the system</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">V[T] := simplify( V[g] + V[e] );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations28.gif" width="190" height="27" alt="V[T] := m[heli]*g*sin(theta(t))*l[cm]" />
</p>
<p align="left">
</p>
</dl><dl><a name="MapleAutoBookmark13" />
<p align="left">
<b><font color="#000000" size="4">Total Kinetic Energy: </font></b>
<img src="images/2DOF Helicopter Equations29.gif" width="38" height="36" alt="T[T]" align="middle" />
</p>
<p align="left">
<font color="#000000">The total kinetic energy can be expressed in terms of the generalized coordinates and their first-time derivatives.</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations30.gif" width="39" height="32" alt="T[r1]" align="middle" />
<font color="#000000">&nbsp;= kinetic energy due to rotation of arm</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations31.gif" width="35" height="32" alt="J[m]" align="middle" />
<font color="#000000">&nbsp;= moment of inertia of motor and rotary arm.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Tr[1] := kinetic_energy( 'rotation', J[eq_p], qd[1] );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations32.gif" width="182" height="58" alt="Tr[1] := 1/2*J[eq_p]*diff(theta(t),t)^2" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Tr[2] := kinetic_energy( 'rotation', J[eq_y], qd[2] );</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations33.gif" width="185" height="58" alt="Tr[2] := 1/2*J[eq_y]*diff(psi(t),t)^2" />
</p>
<p align="left">
<font color="#000000">v[cm] = cm cartesian velocity (magnitude)</font>
</p>
<p align="left">
<font color="#000000">Tt[2] = cm translational kinetic kinergy</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">v[cm] := n_norm( [ xd[cm], yd[cm], zd[cm] ], 2 ):<br />
Tt := kinetic_energy( 'translation', m[heli], v[cm] );</font></b>
</td></tr>
</table>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations34.gif" width="600" height="58" alt="Tt := 1/2*m[heli]*((-sin(psi(t))*diff(psi(t),t)*cos(theta(t))*l[cm]-cos(psi(t))*sin(theta(t))*diff(theta(t),t)*l[cm])^2+(-cos(psi(t))*diff(psi(t),t)*cos(theta(t))*l[cm]+sin(psi(t))*sin(theta(t))*diff(t..." />
<br />
<img src="images/2DOF Helicopter Equations35.gif" width="729" height="58" alt="Tt := 1/2*m[heli]*((-sin(psi(t))*diff(psi(t),t)*cos(theta(t))*l[cm]-cos(psi(t))*sin(theta(t))*diff(theta(t),t)*l[cm])^2+(-cos(psi(t))*diff(psi(t),t)*cos(theta(t))*l[cm]+sin(psi(t))*sin(theta(t))*diff(t..." />
</p>
<p align="left">
<font color="#000000">Total kinetic energy</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">T[T] := Tr[1] + Tr[2] + Tt;<br />
T[T] := collect( T[T], diff ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations36.gif" width="887" height="58" alt="T[T] := 1/2*J[eq_p]*diff(theta(t),t)^2+1/2*J[eq_y]*diff(psi(t),t)^2+1/2*m[heli]*((-sin(psi(t))*diff(psi(t),t)*cos(theta(t))*l[cm]-cos(psi(t))*sin(theta(t))*diff(theta(t),t)*l[cm])^2+(-cos(psi(t))*diff(..." />
<br />
<img src="images/2DOF Helicopter Equations37.gif" width="729" height="58" alt="T[T] := 1/2*J[eq_p]*diff(theta(t),t)^2+1/2*J[eq_y]*diff(psi(t),t)^2+1/2*m[heli]*((-sin(psi(t))*diff(psi(t),t)*cos(theta(t))*l[cm]-cos(psi(t))*sin(theta(t))*diff(theta(t),t)*l[cm])^2+(-cos(psi(t))*diff(..." />
</p>
<p align="left">
</p>
</dl></dl><dl><a name="MapleAutoBookmark14" />
<p align="left">
<b><font color="#000000" size="5">Generalized Forces: </font></b>
<img src="images/2DOF Helicopter Equations38.gif" width="38" height="48" alt="Q[i]" align="middle" />
<b><font color="#000000" size="5">'s</font></b>
</p>
<p align="left">
<font color="#000000">The non-conservative forces corresponding to the generalized coordinates are: </font>
<img src="images/2DOF Helicopter Equations39.gif" width="35" height="32" alt="tau[m]" align="middle" />
<font color="#000000">&nbsp;and the viscous damping forces, where</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations40.gif" width="31" height="32" alt="tau[p]" align="middle" />
<font color="#000000">&nbsp;= torque acting on pitch axis</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations41.gif" width="30" height="32" alt="tau[y]" align="middle" />
<font color="#000000">&nbsp;= torque acting on yaw axis</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations42.gif" width="56" height="32" alt="B[eq,p]" align="middle" />
<font color="#000000">&nbsp;= pitch viscous friction torque coefficient (a.k.a. viscous damping)</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations43.gif" width="55" height="32" alt="B[eq,y]" align="middle" />
<font color="#000000">&nbsp;= yaw viscous friction torque coefficient (a.k.a. viscous damping)</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations44.gif" width="56" height="32" alt="B[eq,p]" align="middle" />
<font color="#000000">&nbsp;= 0 and </font>
<img src="images/2DOF Helicopter Equations45.gif" width="80" height="32" alt="B[eq,y] = 0" align="middle" />
<font color="#000000">&nbsp;if both viscous dampings are neglected</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">#B[eq_p] := 0:<br />
#B[eq_y] := 0:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Q[i] = generalized force applied on generalized coordinate q[i]</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Q[1] := tau[p] - B[p] * qd[1];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations46.gif" width="168" height="45" alt="Q[1] := tau[p]-B[p]*diff(theta(t),t)" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Q[2] := tau[y] - B[y] * qd[2];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations47.gif" width="170" height="45" alt="Q[2] := tau[y]-B[y]*diff(psi(t),t)" />
</p>
<p align="left">
<font color="#000000">rm: comment the following line out if </font>
<img src="images/2DOF Helicopter Equations48.gif" width="102" height="36" alt="u = [tau[p], tau[y]]^T" align="middle" />
<font color="#000000">, uncomment it if </font>
<img src="images/2DOF Helicopter Equations49.gif" width="104" height="36" alt="u = [v[p], v[y]]^T" align="middle" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">tau[p] := K[pp] * V[m_p] &nbsp;+ K[py] * V[m_y];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations50.gif" width="204" height="27" alt="tau[p] := K[pp]*V[m_p]+K[py]*V[m_y]" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">tau[y] := K[yy] * V[m_y] + K[yp] * V[m_p];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations51.gif" width="201" height="27" alt="tau[y] := K[yy]*V[m_y]+K[yp]*V[m_p]" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Q := [ seq( Q[i], i=1..Nq ) ];</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations52.gif" width="574" height="45" alt="Q := [K[pp]*V[m_p]+K[py]*V[m_y]-B[p]*diff(theta(t),t), K[yy]*V[m_y]+K[yp]*V[m_p]-B[y]*diff(psi(t),t)]" />
</p>
</dl><dl><a name="MapleAutoBookmark15" />
<p align="left">
<b><font color="#000000" size="5">Euler-Lagrange's Equations</font></b>
</p>
<p align="left">
<font color="#000000">For a </font>
<i><font color="#000000">N</font></i>
<font color="#000000">-DOF system, the Lagrange's equations can be written:</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations53.gif" width="217" height="58" alt="Diff(Diff(L,qdot[i]),t)-Diff(L,q[i]) = Q[i]" align="middle" />
<font color="#000000">&nbsp;&nbsp;for </font>
<img src="images/2DOF Helicopter Equations54.gif" width="45" height="32" alt="i = 1" align="middle" />
<font color="#000000">&nbsp;through </font>
<img src="images/2DOF Helicopter Equations55.gif" width="27" height="32" alt="N" align="middle" />
</p>
<p align="left">
<font color="#000000">where:</font>
</p>
<p align="left">
<font color="#000000">&nbsp;</font>
<img src="images/2DOF Helicopter Equations56.gif" width="31" height="32" alt="Q[i]" align="middle" />
<font color="#000000">'s are special combinations of external forces and called the </font>
<i><font color="#000000">generalized forces,</font></i>
</p>
<p align="left">
<i><font color="#000000">&nbsp;</font></i>
<img src="images/2DOF Helicopter Equations57.gif" width="32" height="32" alt="q[1]" align="middle" />
<font color="#000000">, ..., </font>
<img src="images/2DOF Helicopter Equations58.gif" width="35" height="32" alt="q[N]" align="middle" />
<font color="#000000">, are </font>
<i><font color="#000000">N </font></i>
<font color="#000000">independent coordinates chosen to describe the system and called the </font>
<i><font color="#000000">generalized coordinates</font></i>
<font color="#000000">,</font>
</p>
<p align="left">
<font color="#000000">&nbsp;and </font>
<img src="images/2DOF Helicopter Equations59.gif" width="25" height="32" alt="L" align="middle" />
<font color="#000000">&nbsp;is the </font>
<i><font color="#000000">Lagrangian</font></i>
<font color="#000000">&nbsp;of the system.</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations60.gif" width="25" height="32" alt="L" align="middle" />
<font color="#000000">&nbsp;is defined by:</font>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations61.gif" width="80" height="20" alt="L = T-U" />
</p>
<p align="left">
<font color="#000000">where </font>
<img src="images/2DOF Helicopter Equations62.gif" width="25" height="32" alt="T" align="middle" />
<font color="#000000">&nbsp;is the total kinetic energy of the system and </font>
<img src="images/2DOF Helicopter Equations63.gif" width="28" height="32" alt="U" align="middle" />
<font color="#000000">&nbsp;the total potential energy of the system.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_orig := lagrange_equations( T[T], V[T], q, Q ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">this is to display the EOM's</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_orig := collect( EOM_orig, { seq( diff( q[i], t$2 ), i=1..Nq ), seq( diff( q[i], t ), i=1..Nq ), seq( q[i], i=1..Nq ) } ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Express the Euler-Lagrange equations of motion as functions of the states:</font>
</p>
<p align="left">
<font color="#000000">1) substitute (i.e. name) the acceleration states first! </font>
</p>
<p align="left">
<font color="#000000">2) then substitute the velocity states!</font>
</p>
<p align="left">
<font color="#000000">3) and only after, the position states, and the inputs!</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_states := subs( subs_Xqd, subs( subs_Xqdd, EOM_orig ) ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_states := subs( subs_Xq, subs_U, EOM_states ):</font></b>
</td></tr>
</table>
</p>
<dl><a name="MapleAutoBookmark16" />
<p align="left">
<b><font color="#000000" size="4">Linearization &nbsp;in the EOM's</font></b>
<font color="#000000" size="4">&nbsp;</font>
<b><font color="#000000" size="4">of the Trigonometric Functions</font></b>
</p>
<p align="left">
<font color="#000000">Linearization of the equations of motion around the quiescent point of operation (in order to solve them).</font>
</p>
<p align="left">
<font color="#000000">Here, linearization around the zero angles, i.e. for small-amplitude oscillations.</font>
</p>
<p align="left">
<font color="#000000">Linearization around: </font>
<img src="images/2DOF Helicopter Equations64.gif" width="57" height="32" alt="theta[0] = 0" align="middle" />
<font color="#000000">, </font>
<img src="images/2DOF Helicopter Equations65.gif" width="74" height="58" alt="Diff(theta[0],t) = 0" align="middle" />
<font color="#000000">, </font>
<img src="images/2DOF Helicopter Equations66.gif" width="61" height="32" alt="psi[0] = 0" align="middle" />
<font color="#000000">, &nbsp;and </font>
<img src="images/2DOF Helicopter Equations67.gif" width="78" height="58" alt="Diff(psi[0],t) = 0" align="middle" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_ser := EOM_states:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Generalized series expansions of the trigonometric functions is used (for small angles).</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EOM_ser[i] := subsop( 1 = convert( series( op( 1, EOM_ser[i] ), X[ 1 ] ), polynom ), EOM_ser[i] );<br />
&nbsp;&nbsp;EOM_ser[i] := simplify( EOM_ser[i] );<br />
end do:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">EOM_ser;</font></b>
</td></tr>
</table>
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations68.gif" width="636" height="29" alt="[Xd[3]*J[eq_p]+Xd[3]*m[heli]*l[cm]^2+m[heli]*g*l[cm]+m[heli]*X[4]^2*l[cm]^2*X[1] = K[pp]*U[1]+K[py]*U[2]-B[p]*X[3], (J[eq_y]+m[heli]*l[cm]^2)*Xd[4]-2*m[heli]*X[4]*l[cm]^2*X[3]*X[1] = K[yy]*U[2]+K[yp]*U..." />
<br />
<img src="images/2DOF Helicopter Equations69.gif" width="546" height="29" alt="[Xd[3]*J[eq_p]+Xd[3]*m[heli]*l[cm]^2+m[heli]*g*l[cm]+m[heli]*X[4]^2*l[cm]^2*X[1] = K[pp]*U[1]+K[py]*U[2]-B[p]*X[3], (J[eq_y]+m[heli]*l[cm]^2)*Xd[4]-2*m[heli]*X[4]*l[cm]^2*X[3]*X[1] = K[yy]*U[2]+K[yp]*U..." />
</p>
<p align="left">
</p>
</dl><dl><a name="MapleAutoBookmark17" />
<p align="left">
<b><font color="#000000" size="4">Additional Insight: Inertia (or mass) Matrix: Fi</font></b>
</p>
<p align="left">
<font color="#000000">The nonlinear system of equations resulting from the Lagrangian mechanics can be written in the following matrix form:</font>
</p>
<p align="left">
<font color="#000000">F( q ) . qdd + G( q, qd ) . qd + H( q ) . q = L( q, qd, u )</font>
</p>
<p align="left">
<font color="#000000">F, G, and H are called, respectively, the mass, damping, and stiffness matrices.</font>
</p>
<p align="left">
<font color="#000000">They are symmetric in form.</font>
</p>
<p align="left">
<font color="#000000">The inertia (a.k.a. mass) matrix, F, gives indications regarding the coupling existing in the system.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Fi := Matrix( Nq, Nq ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;for k from 1 to Nq do<br />
&nbsp;&nbsp;&nbsp;&nbsp;Fi[ i, k ] := simplify( diff( op( 1, EOM_states[i] ), Xd[k+Nq] ) );<br />
&nbsp;&nbsp;&nbsp;&nbsp;Fi[ i, k ] := collect( combine( Fi[ i, k ], trig ), cos );<br />
&nbsp;&nbsp;end do;<br />
end do:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">'F[i]' = Fi;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations70.gif" width="507" height="84" alt="F[i] = Matrix(%id = 485352)" />
</p>
<p align="left">
<font color="#000000">Linearization of the inertia matrix for small-displacements</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Fi_lin := Matrix( Nq, Nq ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;for k from 1 to Nq do<br />
&nbsp;&nbsp;&nbsp;&nbsp;Fi_lin[ i, k ] := Fi[ i, k ];<br />
&nbsp;&nbsp;&nbsp;&nbsp;Fi_lin[ i, k ] := convert( series( Fi_lin[ i, k ], X[ 1 ] ), polynom );<br />
&nbsp;&nbsp;&nbsp;&nbsp;Fi_lin[ i, k ] := subs( subs_XUzero, Fi_lin[ i, k ] );<br />
&nbsp;&nbsp;end do; <br />
end do:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">'F_lin' = Fi_lin;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations71.gif" width="346" height="68" alt="F_lin = Matrix(%id = 636292)" />
</p>
<p align="left">
</p>
</dl></dl><dl><a name="MapleAutoBookmark18" />
<p align="left">
<b><font color="#000000" size="5">Solving the Euler-Lagrange's Equations</font></b>
</p>
<dl><a name="MapleAutoBookmark19" />
<p align="left">
<b><font color="#000000" size="4">Reverse State Substitution for Pretty Display of the Solved EOM's</font></b>
</p>
<p align="left">
<font color="#000000">only for pretty print</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_Xq_rev := { seq( X[i] = q[i], i=1..Nq ) }:<br />
subs_Xqd_rev := { seq( X[i+Nq] = qd[i], i=1..Nq ) }:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_U_rev := { U[1] = V[m_p], U[2] = V[m_y] }: <br />
#subs_U_rev := { U[1] = tau[m] }:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">eom_collect_list := { seq( diff( q[i], t ), i=1..Nq ), seq( q[i], i=1..Nq ), J[eq_p], J[eq_y], V[m_p], V[m_y] };</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations72.gif" width="515" height="45" alt="eom_collect_list := {V[m_p], V[m_y], J[eq_p], diff(theta(t),t), diff(psi(t),t), theta(t), psi(t), J[eq_y]}" />
</p>
<p align="left">
</p>
</dl><p align="left">
</p>
<dl><a name="MapleAutoBookmark20" />
<p align="left">
<b><font color="#000000" size="4">Solution to the Non-Linear Equations of Motion</font></b>
</p>
<p align="left">
<font color="#000000">Solve the non-linear form of the equations of motion for the states' second time derivatives</font>
</p>
<p align="left">
<font color="#000000">NOTE: These computations take long and therefore they have been commented.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Xqdd_solset_nl := solve( convert( EOM_states, set ), convert( Xqdd, set ) ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">assign( Xqdd_solset_nl );</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do <br />
&nbsp;&nbsp;Xd_nl[i+Nq] := simplify( Xd[i+Nq] ):<br />
&nbsp;&nbsp;unassign( 'Xd[i+Nq]' ):<br />
end do:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">pretty display w.r.t. the named system states</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;Xd_nl[i+Nq] := simplify( subs( subs_U_rev, subs_Xq_rev, subs_Xqd_rev, Xd_nl[i+Nq] )):<br />
end do;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations73.gif" width="808" height="92" alt="Xd_nl[3] := -(-K[pp]*V[m_p]-K[py]*V[m_y]+m[heli]*diff(psi(t),t)^2*sin(theta(t))*l[cm]^2*cos(theta(t))+m[heli]*g*cos(theta(t))*l[cm]+B[p]*diff(theta(t),t))/(J[eq_p]+m[heli]*l[cm]^2)" />
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations74.gif" width="697" height="86" alt="Xd_nl[4] := (2*m[heli]*diff(psi(t),t)*sin(theta(t))*l[cm]^2*cos(theta(t))*diff(theta(t),t)+K[yy]*V[m_y]+K[yp]*V[m_p]-B[y]*diff(psi(t),t))/(J[eq_y]+m[heli]*cos(theta(t))^2*l[cm]^2)" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;diff( qd[i], t ) = collect( Xd_nl[i+Nq], eom_collect_list );<br />
end do;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations75.gif" width="914" height="92" alt="diff(theta(t),`$`(t,2)) = K[pp]/(J[eq_p]+m[heli]*l[cm]^2)*V[m_p]+K[py]/(J[eq_p]+m[heli]*l[cm]^2)*V[m_y]-(B[p]*diff(theta(t),t)+m[heli]*diff(psi(t),t)^2*sin(theta(t))*l[cm]^2*cos(theta(t))+m[heli]*g*cos..." />
</p>
<p align="left">
<img src="images/2DOF Helicopter Equations76.gif" width="878" height="86" alt="diff(psi(t),`$`(t,2)) = K[yp]/(J[eq_y]+m[heli]*cos(theta(t))^2*l[cm]^2)*V[m_p]+K[yy]/(J[eq_y]+m[heli]*cos(theta(t))^2*l[cm]^2)*V[m_y]+2*m[heli]*diff(psi(t),t)*sin(theta(t))*l[cm]^2*cos(theta(t))/(J[eq_..." />
<br />
<img src="images/2DOF Helicopter Equations77.gif" width="237" height="86" alt="diff(psi(t),`$`(t,2)) = K[yp]/(J[eq_y]+m[heli]*cos(theta(t))^2*l[cm]^2)*V[m_p]+K[yy]/(J[eq_y]+m[heli]*cos(theta(t))^2*l[cm]^2)*V[m_y]+2*m[heli]*diff(psi(t),t)*sin(theta(t))*l[cm]^2*cos(theta(t))/(J[eq_..." />
</p>
</dl><dl><a name="MapleAutoBookmark21" />
<p align="left">
<b><font color="#000000" size="4">Solution to the Linearized EOM's</font></b>
</p>
<p align="left">
<font color="#000000">Solve the linear form of the equations of motion for the states' second time derivatives</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Xqdd_solset_ser := solve( convert( EOM_ser, set ), convert( Xqdd, set ) ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">assign( Xqdd_solset_ser );</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">Moreover, for small angles</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">subs_avsq_list := { X[Nq+2]^2 = 0, X[Nq+3]^2 = 0 }:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;Xd[i+Nq] := subs( subs_avsq_list, Xd[i+Nq] );<br />
end:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">pretty display w.r.t. the named system states</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">for i from 1 to Nq do<br />
&nbsp;&nbsp;diff( qd[i], t ) = collect( subs( subs_U_rev, subs_Xq_rev, subs_Xqd_rev, Xd[i+Nq] ), eom_collect_list );<br />
end do;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations78.gif" width="556" height="79" alt="diff(theta(t),`$`(t,2)) = K[pp]/(J[eq_p]+m[heli]*l[cm]^2)*V[m_p]+K[py]/(J[eq_p]+m[heli]*l[cm]^2)*V[m_y]-1/(J[eq_p]+m[heli]*l[cm]^2)*(m[heli]*g*l[cm]+B[p]*diff(theta(t),t))" />
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations79.gif" width="778" height="79" alt="diff(psi(t),`$`(t,2)) = K[yp]/(J[eq_y]+m[heli]*l[cm]^2)*V[m_p]+K[yy]/(J[eq_y]+m[heli]*l[cm]^2)*V[m_y]+2*m[heli]*diff(psi(t),t)*l[cm]^2*theta(t)/(J[eq_y]+m[heli]*l[cm]^2)*diff(theta(t),t)-B[y]*diff(psi(..." />
</p>
<p align="left">
</p>
</dl></dl><dl><a name="MapleAutoBookmark22" />
<p align="left">
<b><font color="#000000" size="5">Determine the System State-Space Matrices: A, B, C, and D</font></b>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">A_ss := Matrix( Nx, Nx ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">A_ss := deriveA( Xqdd, A_ss, Nq, subs_XUzero ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">'A' = A_ss;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations80.gif" width="404" height="192" alt="A = Matrix(%id = 589664)" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">B_ss := Matrix( Nx, Nu ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">B_ss := deriveB( Xqdd, B_ss, Nq, subs_XUzero ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">'B' = B_ss;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations81.gif" width="330" height="192" alt="B = Matrix(%id = 671612)" />
</p>
<p align="left">
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">C_ss := IdentityMatrix( Nx, Nx ):<br />
'C' = C_ss;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations82.gif" width="164" height="110" alt="C = Matrix(%id = 750472)" />
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">D_ss := Matrix( Nx, Nu, 0 ):<br />
'D' = D_ss;</font></b>
</td></tr>
</table>
</p>
<p align="center">
<img src="images/2DOF Helicopter Equations83.gif" width="110" height="110" alt="D = Matrix(%id = 709332)" />
</p>
<p align="left">
</p>
</dl><p align="left">
</p>
<dl><a name="MapleAutoBookmark23" />
<p align="left">
<b><font color="#000000" size="5">Write A, B, C, and D to a Matlab file</font></b>
</p>
<p align="left">
<font color="#000000">Save the state-space matrices A, B, C and D to a MATLAB file.</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Matlab_File_Name := "HELI_2D_ABCD_eqns.m":</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">unassign variables, when necessary, for those present in the "Matlab_Notations" substitution set</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">if assigned( B[p] ) then<br />
&nbsp;&nbsp;unassign( 'B[p]' );<br />
end if;</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">if assigned( B[y] ) then<br />
&nbsp;&nbsp;unassign( 'B[y]' );<br />
end if;</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">if assigned( J[eq_p] ) then<br />
&nbsp;&nbsp;unassign( 'J[eq_p]' );<br />
end if;</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">if assigned( J[eq_y] ) then<br />
&nbsp;&nbsp;unassign( 'J[eq_y]' );<br />
end if;</font></b>
</td></tr>
</table>
</p>
<p align="left">
<font color="#000000">substitution set containing a notation consistent with that used in the MATLAB design script(s)</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Matlab_Notations := {m[heli] = m_heli, l[cm] = l_cm, J[eq_p] = J_eq_p, J[eq_y]=J_eq_y, B[p] = B_p, B[y] = B_y, K[pp] = K_pp, K[yy] = K_yy, K[py] = K_py, K[yp] = K_yp, R[m_p] = R_m_p, R[m_y] = R_m_y, r[p] = r_p, r[y] = r_y}:</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">Experiment_Name := "2 DOF Helicopter":</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">write_ABCD_to_Mfile( Matlab_File_Name, Experiment_Name, Matlab_Notations, A_ss, B_ss, C_ss, D_ss );</font></b>
</td></tr>
</table>
</p>
</dl><dl><a name="MapleAutoBookmark24" />
<p align="left">
<b><font color="#000000" size="5">Procedure Printing</font></b>
</p>
<p align="left">
<font color="#000000">default:</font>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">interface( verboseproc = 1 );</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"><b><font color="#FF0000">eval( lagrange_equations ):</font></b>
</td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
<table width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top"><tt>&gt; &nbsp;&nbsp;</tt></td>
<td width="100%" valign="top"></td></tr>
</table>
</p>
<p align="left">
</p>
</dl><p align="left">
<a href="2DOF Helicopter Equations1.html#Description" target="Content">Click here to go back to top: Description Section</a><font color="#000000">.</font>
</p>
</basefont>
</body>
</html>
